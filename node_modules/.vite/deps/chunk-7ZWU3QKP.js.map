{
  "version": 3,
  "sources": ["../../../dev/gui/src/2D/controls/stackPanel.ts"],
  "sourcesContent": ["import { Container } from \"./container\";\r\nimport type { Measure } from \"../measure\";\r\nimport { Control } from \"./control\";\r\nimport { RegisterClass } from \"core/Misc/typeStore\";\r\nimport { serialize } from \"core/Misc/decorators\";\r\nimport type { AdvancedDynamicTexture } from \"../advancedDynamicTexture\";\r\nimport type { ICanvasRenderingContext } from \"core/Engines/ICanvas\";\r\nimport { Logger } from \"core/Misc/logger\";\r\n\r\n/**\r\n * Class used to create a 2D stack panel container\r\n */\r\nexport class StackPanel extends Container {\r\n    private _isVertical = true;\r\n    private _manualWidth = false;\r\n    private _manualHeight = false;\r\n    private _doNotTrackManualChanges = false;\r\n    private _spacing = 0;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that layout warnings should be ignored\r\n     */\r\n    @serialize()\r\n    public ignoreLayoutWarnings = false;\r\n\r\n    /** Gets or sets a boolean indicating if the stack panel is vertical or horizontal*/\r\n    @serialize()\r\n    public get isVertical(): boolean {\r\n        return this._isVertical;\r\n    }\r\n\r\n    public set isVertical(value: boolean) {\r\n        if (this._isVertical === value) {\r\n            return;\r\n        }\r\n\r\n        this._isVertical = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the spacing (in pixels) between each child.\r\n     */\r\n    @serialize()\r\n    public get spacing(): number {\r\n        return this._spacing;\r\n    }\r\n\r\n    public set spacing(value: number) {\r\n        if (this._spacing === value) {\r\n            return;\r\n        }\r\n\r\n        this._spacing = value;\r\n        this._markAsDirty();\r\n    }\r\n\r\n    /**\r\n     * Gets or sets panel width.\r\n     * This value should not be set when in horizontal mode as it will be computed automatically\r\n     */\r\n    @serialize()\r\n    public override set width(value: string | number) {\r\n        if (!this._doNotTrackManualChanges) {\r\n            this._manualWidth = true;\r\n        }\r\n\r\n        if (this._width.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._width.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    public override get width(): string | number {\r\n        return this._width.toString(this._host);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets panel height.\r\n     * This value should not be set when in vertical mode as it will be computed automatically\r\n     */\r\n    @serialize()\r\n    public override set height(value: string | number) {\r\n        if (!this._doNotTrackManualChanges) {\r\n            this._manualHeight = true;\r\n        }\r\n\r\n        if (this._height.toString(this._host) === value) {\r\n            return;\r\n        }\r\n\r\n        if (this._height.fromString(value)) {\r\n            this._markAsDirty();\r\n        }\r\n    }\r\n\r\n    public override get height(): string | number {\r\n        return this._height.toString(this._host);\r\n    }\r\n\r\n    /**\r\n     * Creates a new StackPanel\r\n     * @param name defines control name\r\n     */\r\n    constructor(public override name?: string) {\r\n        super(name);\r\n    }\r\n\r\n    protected override _getTypeName(): string {\r\n        return \"StackPanel\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    protected override _preMeasure(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        for (const child of this._children) {\r\n            if (this._isVertical) {\r\n                child.verticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\r\n            } else {\r\n                child.horizontalAlignment = Control.HORIZONTAL_ALIGNMENT_LEFT;\r\n            }\r\n        }\r\n\r\n        super._preMeasure(parentMeasure, context);\r\n    }\r\n\r\n    protected override _additionalProcessing(parentMeasure: Measure, context: ICanvasRenderingContext): void {\r\n        super._additionalProcessing(parentMeasure, context);\r\n\r\n        this._measureForChildren.copyFrom(parentMeasure);\r\n\r\n        this._measureForChildren.left = this._currentMeasure.left;\r\n        this._measureForChildren.top = this._currentMeasure.top;\r\n\r\n        if (!this.isVertical || this._manualWidth) {\r\n            this._measureForChildren.width = this._currentMeasure.width;\r\n        }\r\n\r\n        if (this.isVertical || this._manualHeight) {\r\n            this._measureForChildren.height = this._currentMeasure.height;\r\n        }\r\n    }\r\n\r\n    protected override _postMeasure(): void {\r\n        let stackWidth = 0;\r\n        let stackHeight = 0;\r\n        const childrenCount = this._children.length;\r\n\r\n        // Calculate scaled spacing using idealRatio (same pattern as shadowOffset)\r\n        const scaledSpacing = this._spacing * this._host.idealRatio;\r\n\r\n        for (let index = 0; index < childrenCount; index++) {\r\n            const child = this._children[index];\r\n            if (!child.isVisible || child.notRenderable) {\r\n                continue;\r\n            }\r\n\r\n            if (this._isVertical) {\r\n                const top = stackHeight + \"px\";\r\n                if (child.top !== top) {\r\n                    child.top = top;\r\n                    this._rebuildLayout = true;\r\n                    child._top.ignoreAdaptiveScaling = true;\r\n                }\r\n\r\n                if (!this.ignoreLayoutWarnings && !child.isDimensionFullyDefined(\"height\")) {\r\n                    Logger.Warn(`Control (Name:${child.name}, UniqueId:${child.uniqueId}) is using height in percentage mode inside a vertical StackPanel`, 1);\r\n                } else {\r\n                    stackHeight += child._currentMeasure.height + child._paddingTopInPixels + child._paddingBottomInPixels + (index < childrenCount - 1 ? scaledSpacing : 0);\r\n                }\r\n            } else {\r\n                const left = stackWidth + \"px\";\r\n                if (child.left !== left) {\r\n                    child.left = left;\r\n                    this._rebuildLayout = true;\r\n                    child._left.ignoreAdaptiveScaling = true;\r\n                }\r\n\r\n                if (!this.ignoreLayoutWarnings && !child.isDimensionFullyDefined(\"width\")) {\r\n                    Logger.Warn(`Control (Name:${child.name}, UniqueId:${child.uniqueId}) is using width in percentage mode inside a horizontal StackPanel`, 1);\r\n                } else {\r\n                    stackWidth += child._currentMeasure.width + child._paddingLeftInPixels + child._paddingRightInPixels + (index < childrenCount - 1 ? scaledSpacing : 0);\r\n                }\r\n            }\r\n        }\r\n\r\n        stackWidth += this._paddingLeftInPixels + this._paddingRightInPixels;\r\n        stackHeight += this._paddingTopInPixels + this._paddingBottomInPixels;\r\n\r\n        this._doNotTrackManualChanges = true;\r\n\r\n        // Let stack panel width or height default to stackHeight and stackWidth if dimensions are not specified.\r\n        // User can now define their own height and width for stack panel.\r\n\r\n        let panelWidthChanged = false;\r\n        let panelHeightChanged = false;\r\n\r\n        if ((!this._manualHeight || this.adaptHeightToChildren) && this._isVertical) {\r\n            // do not specify height if strictly defined by user\r\n            const previousHeight = this.height;\r\n            this.height = stackHeight + \"px\";\r\n            panelHeightChanged = previousHeight !== this.height || !this._height.ignoreAdaptiveScaling;\r\n        }\r\n        if ((!this._manualWidth || this.adaptWidthToChildren) && !this._isVertical) {\r\n            // do not specify width if strictly defined by user\r\n            const previousWidth = this.width;\r\n            this.width = stackWidth + \"px\";\r\n            panelWidthChanged = previousWidth !== this.width || !this._width.ignoreAdaptiveScaling;\r\n        }\r\n\r\n        if (panelHeightChanged) {\r\n            this._height.ignoreAdaptiveScaling = true;\r\n        }\r\n\r\n        if (panelWidthChanged) {\r\n            this._width.ignoreAdaptiveScaling = true;\r\n        }\r\n\r\n        this._doNotTrackManualChanges = false;\r\n\r\n        if (panelWidthChanged || panelHeightChanged) {\r\n            this._rebuildLayout = true;\r\n        }\r\n\r\n        super._postMeasure();\r\n    }\r\n\r\n    private _getManualDim(dim: \"width\" | \"height\") {\r\n        if (dim === \"width\") {\r\n            return this._manualWidth;\r\n        } else {\r\n            return this._manualHeight;\r\n        }\r\n    }\r\n\r\n    public override isDimensionFullyDefined(dim: \"width\" | \"height\"): boolean {\r\n        if (dim === \"height\" ? this.isVertical : !this.isVertical && !this._getManualDim(dim)) {\r\n            for (const child of this._children) {\r\n                if (!child.isDimensionFullyDefined(dim)) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n\r\n        return this.getDimension(dim).isPixel || this._getAdaptDimTo(dim);\r\n    }\r\n\r\n    /**\r\n     * Serializes the current control\r\n     * @param serializationObject defined the JSON serialized object\r\n     * @param force force serialization even if isSerializable === false\r\n     * @param allowCanvas defines if the control is allowed to use a Canvas2D object to serialize\r\n     */\r\n    public override serialize(serializationObject: any, force: boolean, allowCanvas: boolean) {\r\n        super.serialize(serializationObject, force, allowCanvas);\r\n        if (!this.isSerializable && !force) {\r\n            return;\r\n        }\r\n        serializationObject.manualWidth = this._manualWidth;\r\n        serializationObject.manualHeight = this._manualHeight;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public override _parseFromContent(serializedObject: any, host: AdvancedDynamicTexture) {\r\n        this._manualWidth = serializedObject.manualWidth;\r\n        this._manualHeight = serializedObject.manualHeight;\r\n\r\n        super._parseFromContent(serializedObject, host);\r\n    }\r\n}\r\nRegisterClass(\"BABYLON.GUI.StackPanel\", StackPanel);\r\n"],
  "mappings": "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",
  "names": []
}
